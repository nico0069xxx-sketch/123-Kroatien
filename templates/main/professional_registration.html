<script>
document.addEventListener('DOMContentLoaded', function() {
    const typeSelect = document.getElementById('id_professional_type');
    const licenseLabel = document.getElementById('license_label');
    const licenseHelp = document.getElementById('license_help');
    const lang = '{{ lang }}';
    
    // License labels per type
    const licenseLabels = {
        'ge': {
            'real_estate_agent': 'Maklerlizenz-Nummer (Posrednik ID)',
            'construction_company': 'Gewerbeschein-Nummer',
            'lawyer': 'Anwaltskammer-Nummer (HOAK)',
            'tax_advisor': 'Steuerberater-ID',
            'architect': 'Architektenkammer-Nummer'
        },
        'hr': {
            'real_estate_agent': 'Broj posredničke licence (Posrednik ID)',
            'construction_company': 'Broj obrtnice',
            'lawyer': 'Broj HOAK (Hrvatska odvjetnička komora)',
            'tax_advisor': 'ID poreznog savjetnika',
            'architect': 'Broj Hrvatske komore arhitekata'
        }
    };
    
    const licenseHelpTexts = {
        'ge': {
            'real_estate_agent': 'Die kroatische Maklerlizenz vom Wirtschaftsministerium',
            'construction_company': 'Ihre Gewerbeschein-Nummer (Obrt)',
            'lawyer': 'Ihre HOAK-Mitgliedsnummer (Hrvatska odvjetnička komora)',
            'tax_advisor': 'Ihre Registrierungsnummer als Steuerberater',
            'architect': 'Ihre Mitgliedsnummer der kroatischen Architektenkammer'
        },
        'hr': {
            'real_estate_agent': 'Hrvatska posrednička licenca Ministarstva gospodarstva',
            'construction_company': 'Vaš broj obrtnice',
            'lawyer': 'Vaš HOAK članski broj (Hrvatska odvjetnička komora)',
            'tax_advisor': 'Vaš registracijski broj poreznog savjetnika',
            'architect': 'Vaš članski broj Hrvatske komore arhitekata'
        }
    };
    
    // Specialization translations
    const specTranslations = {
        'hr': {
            // Real Estate Agent
            'Wohnimmobilien': 'Stambene nekretnine',
            'Gewerbeimmobilien': 'Poslovne nekretnine',
            'Luxusimmobilien': 'Luksuzne nekretnine',
            'Grundstücke': 'Zemljišta',
            'Ferienimmobilien': 'Nekretnine za odmor',
            'Neubauprojekte & Bauträgerobjekte': 'Novogradnja i investitorski projekti',
            'Investitionsimmobilien': 'Investicijske nekretnine',
            'Auslands- & Käuferbetreuung': 'Podrška stranim kupcima',
            'Projektvermarktung': 'Marketing projekata',
            'Immobilienbewertung': 'Procjena nekretnina',
            'Immobilienverwaltung': 'Upravljanje nekretninama',
            // Construction
            'Neubau': 'Novogradnja',
            'Sanierung & Renovierung': 'Sanacija i renoviranje',
            'Umbau & Erweiterung': 'Prenamjena i proširenje',
            'Rohbau': 'Gruba gradnja',
            'Schlüsselfertiges Bauen': 'Gradnja ključ u ruke',
            'Poolbau': 'Izgradnja bazena',
            'Außenanlagen & Erschließung': 'Vanjski radovi i infrastruktura',
            'Innenausbau': 'Unutarnji radovi',
            'Dach- & Fassadenbau': 'Krovovi i fasade',
            'Beton- & Stahlbetonarbeiten': 'Betonski i armiranobetonski radovi',
            'Küsten- & Hangbebauung': 'Gradnja na obali i padinama',
            'Bau nach kroatischen Normen': 'Gradnja prema hrvatskim normama',
            // Lawyer
            'Immobilienrecht': 'Pravo nekretnina',
            'Baurecht & Raumordnungsrecht': 'Građevinsko i prostorno pravo',
            'Gesellschaftsrecht': 'Pravo društava',
            'Steuerrecht': 'Porezno pravo',
            'Erbrecht & Nachlassplanung': 'Nasljedno pravo',
            'Familienrecht': 'Obiteljsko pravo',
            'Einwanderungs- & Aufenthaltsrecht': 'Imigracijski i boravišni propisi',
            'Vertragsrecht': 'Ugovorno pravo',
            'Verwaltungsrecht': 'Upravno pravo',
            'Grundbuch- & Katasterrecht': 'Zemljišnoknjižno i katastarsko pravo',
            'Due-Diligence-Prüfungen': 'Due diligence provjere',
            'Vertretung vor Behörden & Gerichten': 'Zastupanje pred tijelima i sudovima',
            // Tax Advisor
            'Einkommensteuer': 'Porez na dohodak',
            'Unternehmensbesteuerung': 'Oporezivanje poduzeća',
            'Immobilienbesteuerung': 'Oporezivanje nekretnina',
            'Internationale Steuerberatung': 'Međunarodno porezno savjetovanje',
            'Buchhaltung & Jahresabschlüsse': 'Knjigovodstvo i godišnji izvještaji',
            'Mehrwertsteuer (PDV)': 'Porez na dodanu vrijednost (PDV)',
            'Steueroptimierung für Investoren': 'Porezna optimizacija za investitore',
            'Grenzüberschreitende Strukturen': 'Prekogranične strukture',
            'Selbstständige & Freiberufler': 'Samostalni i slobodne profesije',
            'Steuerliche Vertretung': 'Porezno zastupanje',
            'Ferienvermietung & Tourismusbesteuerung': 'Turistički najam i oporezivanje',
            // Architect
            'Wohnbau': 'Stambena gradnja',
            'Gewerbe- & Tourismusbau': 'Poslovna i turistička gradnja',
            'Innenarchitektur': 'Dizajn interijera',
            'Landschaftsarchitektur': 'Krajobrazna arhitektura',
            'Sanierung & Denkmalpflege': 'Sanacija i zaštita spomenika',
            'Energieeffizientes Bauen': 'Energetski učinkovita gradnja',
            'Genehmigungs- & Einreichplanung': 'Projektiranje za dozvole',
            'Ausführungsplanung': 'Izvedbeno projektiranje',
            '3D-Planung & Visualisierung': '3D planiranje i vizualizacija',
            'Raumordnungs- & Bebauungsberatung': 'Prostorno i urbanističko savjetovanje',
            'Küsten- & Zonenplanung': 'Obalno i zonsko planiranje',
            'Nachhaltiges & ökologisches Bauen': 'Održiva i ekološka gradnja'
        }
    };
    
    function updateSpecializations() {
        const selectedType = typeSelect.value;
        const currentLang = lang || 'ge';
        
        // Hide all spec sections
        document.querySelectorAll('.spec-section').forEach(function(el) {
            el.style.display = 'none';
        });
        
        // Show the relevant one
        const specDiv = document.getElementById('spec_' + selectedType);
        if (specDiv) {
            specDiv.style.display = 'block';
        }
        
        // Update license label
        const labels = licenseLabels[currentLang] || licenseLabels['ge'];
        const helps = licenseHelpTexts[currentLang] || licenseHelpTexts['ge'];
        
        if (labels[selectedType]) {
            licenseLabel.textContent = labels[selectedType];
        }
        if (helps[selectedType]) {
            licenseHelp.textContent = helps[selectedType];
        }
    }
    
    // Translate specializations if Croatian
    function translateSpecializations() {
        if (lang === 'hr' && specTranslations['hr']) {
            document.querySelectorAll('.spec-section .form-check-label').forEach(function(label) {
                const germanText = label.textContent.trim();
                if (specTranslations['hr'][germanText]) {
                    label.textContent = specTranslations['hr'][germanText];
                }
            });
        }
    }
    
    typeSelect.addEventListener('change', updateSpecializations);
    
    // Initial calls
    updateSpecializations();
    translateSpecializations();
});
</script>
